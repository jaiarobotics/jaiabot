---
- name: Upgrade JaiaBot packages
  hosts: all
  gather_facts: no
  become: yes

  tasks:
    - name: Install/upgrade jaiabot packages
      apt:
        update_cache: yes
        name:
          - jaiabot-apps
          - jaiabot-arduino
          - jaiabot-config
          - jaiabot-data-vision
          - jaiabot-embedded
          - jaiabot-python
          - jaiabot-web
          - libjaiabot
          - goby3-apps
          - goby3-gui
          - goby3-moos
          - libgoby3
          - libgoby3-moos
          - libdccl4
        state: latest

    - name: Get current installed version
      shell: "apt-cache policy jaiabot-embedded | grep Installed: | awk '{print $2}'"
      register: current_version
      
    - name: Set facts for current and available versions
      set_fact:
        jaiabot_current_version: "{{ current_version.stdout }}"
